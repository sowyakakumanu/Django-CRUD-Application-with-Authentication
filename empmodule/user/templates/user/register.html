{% extends 'base.html' %}
{% block main %}

<form action="" method="post" id="registerForm" onsubmit="return validateForm()">
    {% csrf_token %}

    {% for i in form %}
        <p>
            {{ i.label }} {{ i }}
            <span class="error-msg" id="{{ i.id_for_label }}_error" style="color:red;"></span>
            {{ i.errors }}
        </p><br>
    {% endfor %}

    <button style="background-color: rgb(16, 156, 107);color: white; margin-left: 6vw;">Register</button>
    <button style="background-color: rgb(16, 33, 223);color: white; margin-left: 4vw;">
        <a href="{% url 'loginurl' %}" style="color:white; text-decoration:none;">Login</a>
    </button>
</form>

<script>
function validateForm() {
    let valid = true;
    document.querySelectorAll(".error-msg").forEach(e => e.innerHTML = "");
    let firstName = document.getElementById("id_first_name");
    let lastName = document.getElementById("id_last_name");
    let username = document.getElementById("id_username");
    let email = document.getElementById("id_email");
    let password1 = document.getElementById("id_password1");
    let password2 = document.getElementById("id_password2");
    if (firstName.value.trim() === "") {
        document.getElementById("id_first_name_error").innerHTML = "First name is required";
        valid = false;
    }
    if (lastName.value.trim() === "") {
        document.getElementById("id_last_name_error").innerHTML = "Last name is required";
        valid = false;
    }
    if (username.value.trim() === "") {
        document.getElementById("id_username_error").innerHTML = "Username is required";
        valid = false;
    }
    if (!email.value.endsWith("@gmail.com")) {
        document.getElementById("id_email_error").innerHTML = "Email must end with @gmail.com";
        valid = false;
    }
    if (password1.value.length < 8) {
        document.getElementById("id_password1_error").innerHTML = "Password must be at least 8 characters";
        valid = false;}
    if (password1.value !== password2.value) {
        document.getElementById("id_password2_error").innerHTML = "Passwords do not match";
        valid = false;
    }

    return valid;
}
</script>

{% endblock %}
